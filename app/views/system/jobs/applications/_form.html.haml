-# form application
-# %p= @application.inspect
-# %p= @application.offer.inspect
%p= @application.offer.contact.full_name
-# %p= @template.inspect
= form_for @application, html: { id: :application_form} do |f|
  - if @application.errors.any?
    #error_explanation
      %h2= "#{pluralize(@application.errors.count, "error")} prohibited this application from being saved:"
      %ul
        - @application.errors.full_messages.each do |msg|
          %li= msg

  = link_to @application.offer.title, @application.offer.link
  = fields_for @application.offer do |fa|
    .field
      = fa.hidden_field :id
  .field
    = f.label :cover_letter
    = f.hidden_field :cover_letter, id: :application_cover_letter
    #editor.textarea{contentEditable: true, data: {content: make_cover_letter(offer: @application.offer) }}

  .actions
    #btn-save.btn.btn-danger=:Save

:css
  .textarea {
    width: 100%;
    min-height: 500px;
    border: solid 1px;
  }

:javascript
  $().ready(function(){
    var editor = document.getElementById('editor')
    $('#editor').html($('#editor').data('content'));
    $('#btn-save').click(function(){
      $('#application_cover_letter').val(editor.innerHTML);
      $('#application_form').submit();
    });
  });
